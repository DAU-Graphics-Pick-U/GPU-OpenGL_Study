name: Auto Merge

on:
  pull_request:
    types:
      - opened

jobs:
  automerge:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Git
      run: |
        git config user.name "Your Bot Name"
        git config user.email "your-bot@example.com"

    - name: Auto Merge
      run: |
        if [ "$(curl -s -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" "https://api.github.com/orgs/DAU-Graphics-Pick-U/members/${{ github.actor }}")" != "Not Found" ]; then
          git checkout "refs/pull/${{ github.event.number }}/merge"
          git merge --no-ff --no-edit "${{ github.event.pull_request.head.sha }}"
          git push origin HEAD
        else
          echo "The pull request author is not a member of the organization."
        fi
